# 国外文件下载器

一个高效的服务器应用，用于简化远程文件下载，支持HTTP/HTTPS直链下载、实时进度跟踪和历史记录管理。适用于需要管理多个文件下载的场景，确保用户轻松跟踪并获取下载历史。

## 功能特性
- **文件下载**：支持从各种文件托管服务（如GitHub等）下载文件到服务器。
- **唯一文件名**：自动生成唯一的文件名以避免重复下载时冲突。
- **实时进度跟踪**：提供下载进度、速度和总文件大小信息。
- **历史记录管理**：永久存储下载历史，可查看和删除记录。
- **文件管理**：支持将下载文件从服务器下载到本地，删除历史记录和文件。
- **错误处理**：支持常见下载错误的处理，并给出明确提示。

## 技术特性
- **后端**：基于Express.js构建，使用axios进行流式下载。
- **前端**：使用HTML/CSS/JavaScript，支持桌面和移动端。
- **存储**：使用fs-extra管理文件存储，history.json存储下载记录。
- **进度跟踪**：使用Map实时存储下载进度。

## 安装与运行
1. **环境要求**：Node.js ≥18.x，支持Linux、macOS和Windows。
2. **安装步骤**：
   - 克隆项目代码。
   - 执行`npm install`安装依赖。
   - 运行`node start`启动服务，默认端口3000。
   
   默认会创建以下目录：
   - `downloads/`：存储下载文件。
   - `temp/`：存储下载过程中的临时文件。
   - `history.json`：存储下载历史记录。

## 使用说明
- **前端操作**：
   - 输入URL，点击“开始”下载，实时查看进度。
   - 下载完成后，点击“下载到本地”保存文件。
   - 查看和删除历史记录。
   
- **后端API**：
   - **开始下载**：`POST /download`，传递文件直链URL。
   - **查询进度**：`GET /progress/:taskId`，返回下载进度。
   - **获取历史记录**：`GET /history`，返回历史记录列表。
   - **下载文件**：`GET /download-file/:filename`，返回文件流。
   - **删除记录**：`DELETE /delete-record/:taskId`，删除任务记录。

## 目录结构
- `downloads/`：存储最终下载的文件。
- `temp/`：临时文件目录。
- `public/`：前端静态资源（`index.html`，`styles.css`）。
- `history.json`：下载历史记录。
- `server.js`：服务器主文件。
- `package.json`：依赖和脚本配置。

## 配置说明
可以通过修改`server.js`中的常量来调整服务行为：
- **DOWNLOAD_DIR**：文件存储目录（默认`./downloads`）。
- **TEMP_DIR**：临时目录（默认`./temp`）。
- **HISTORY_FILE**：历史记录文件路径（默认`./history.json`）。
- **PORT**：服务端口（默认3000）。

## 常见问题
- **下载速度慢？**：受服务器带宽和源文件影响，尝试更换源或提升带宽。
- **文件重复下载会覆盖吗？**：不会，系统自动生成唯一文件名。
- **如何修改服务端口？**：修改`server.js`中的`PORT`常量，重启服务。
- **历史记录丢失？**：历史记录文件会自动创建，删除的记录无法恢复。
